# NetVis Pro 开发进度报告

> 更新时间：2025-12-14

---

## 一、项目概述

**NetVis Pro** 是一个企业级网络设备拓扑可视化平台，面向中大型数据中心的网络运维场景。

### 技术栈

| 层级     | 技术                      | 状态    |
| -------- | ------------------------- | ------- |
| 前端     | React + Vite + Ant Design | ✅ 完成 |
| 业务 API | Bun + Hono + Drizzle ORM  | ✅ 完成 |
| 数据库   | PostgreSQL + SQLite       | ✅ 完成 |
| 部署     | Docker Compose + Nginx    | ✅ 完成 |
| 采集层   | Go + gosnmp               | ✅ 完成 |
| 时序库   | TimescaleDB               | ✅ 完成 |

---

## 二、功能模块完成情况

### 已完成模块 ✅

| 模块代码      | 模块名称   | 前端 | 后端 | 说明                  |
| ------------- | ---------- | :--: | :--: | --------------------- |
| **CORE**      | 仪表盘     |  ✅  |  ✅  | Dashboard 统计卡片    |
| **TOPO**      | 拓扑可视化 |  ✅  |  ✅  | 2D/3D 拓扑图          |
| **ASSET**     | 资产管理   |  ✅  |  ✅  | 设备 CRUD、分组       |
| **ALERT**     | 告警管理   |  ✅  |  ✅  | 告警列表、确认、统计  |
| **USER**      | 用户管理   |  ✅  |  ✅  | 用户 CRUD、角色权限   |
| **AUTH**      | 认证授权   |  ✅  |  ✅  | JWT 登录、RBAC        |
| **AUDIT**     | 审计日志   |  ✅  |  ✅  | 操作记录、导出        |
| **LICENSE**   | 授权管理   |  ✅  |  ⚠️  | UI 完成，后端需强化   |
| **CONFIG**    | 配置管理   |  ✅  |  ⚠️  | UI 完成，后端模拟数据 |
| **REPORT**    | 报表中心   |  ✅  |  ⚠️  | UI 完成，后端模拟数据 |
| **API**       | 开放 API   |  ✅  |  ✅  | API Key/Webhook 管理  |
| **NOTIFY**    | 通知中心   |  ✅  |  ✅  | 站内通知、渠道设置    |
| **SYSTEM**    | 系统监控   |  ✅  |  ✅  | 健康检查、运维工具    |
| **SEARCH**    | 全局搜索   |  ✅  |  ✅  | Cmd+K 快捷搜索        |
| **ANALYTICS** | 数据分析   |  ✅  |  ✅  | 趋势图、TOP 统计      |

### 待开发模块 📋

| 模块代码      | 模块名称     | 优先级 | 依赖         | 状态      |
| ------------- | ------------ | :----: | ------------ | --------- |
| **COLLECTOR** | Go 采集器    | 🔴 高  | 新建 Go 项目 | ✅ 完成   |
| **SSH**       | SSH 设备管理 | 🔴 高  | Go 采集器    | ✅ 完成   |
| **DISCOVERY** | 自动发现     | 🟡 中  | Go 采集器    | ✅ 完成   |
| **MOBILE**    | 移动端 H5    | 🟡 中  | -            | ✅ 完成   |
| **HA**        | 多活灾备     | 🟢 低  | 基础设施     | 📋 待开发 |

---

## 三、后端 API 路由清单

### 已实现的 43 个 API 模块

| 路由前缀               | 模块     | 主要接口                              |
| ---------------------- | -------- | ------------------------------------- |
| `/api/auth`            | 认证     | login, register, me, logout, password |
| `/api/users`           | 用户     | CRUD, 角色分配                        |
| `/api/devices`         | 设备     | CRUD, 批量导入导出                    |
| `/api/alerts`          | 告警     | 列表, 确认, 统计                      |
| `/api/analytics`       | 分析     | dashboard, trends, top 设备           |
| `/api/license`         | 授权     | info, import, usage, modules          |
| `/api/audit`           | 审计     | 列表, 统计, 导出                      |
| `/api/openapi`         | 开放 API | keys, webhooks                        |
| `/api/config`          | 配置     | backups, deploy, templates            |
| `/api/report`          | 报表     | types, generate, history, schedules   |
| `/api/notifications`   | 通知     | 列表, 已读, 设置                      |
| `/api/system`          | 系统     | health, metrics, tasks, logs, backups |
| `/api/health`          | 健康     | 健康检查, Prometheus 指标             |
| `/api/discovery`       | 发现     | 网段扫描, 设备导入                    |
| `/api/schedule`        | 定时     | 任务 CRUD, 执行历史                   |
| `/api/collector`       | 采集器   | 注册, 心跳, 设备分配                  |
| `/api/metrics`         | 指标     | 时序查询, 聚合统计                    |
| `/api/snmp`            | SNMP     | 模板管理, 采集配置                    |
| `/api/backup`          | 备份     | 创建, 恢复, 下载                      |
| `/api/logs`            | 日志     | 系统日志, 审计日志                    |
| `/api/groups`          | 分组     | 设备分组 CRUD, 批量分配               |
| `/api/templates`       | 模板     | 通知模板 CRUD, 预览测试               |
| `/api/device-health`   | 健康评分 | 设备评分, 等级分布                    |
| `/api/topology-manage` | 拓扑     | 连接 CRUD, 自动发现                   |
| `/api/api-stats`       | API 统计 | 调用统计, 趋势分析                    |
| `/api/maintenance`     | 维护     | 计划 CRUD, 状态管理                   |
| `/api/ssh`             | SSH      | 凭据管理、命令执行、模板              |
| `/api/traffic`         | 流量     | 接口流量、概览、趋势                  |
| `/api/baseline`        | 基线     | 性能基线、异常检测                    |
| `/api/wxwork`          | 企微     | 配置管理、消息发送、通讯录            |
| `/api/compliance`      | 合规     | 规则管理、合规扫描、违规列表          |
| `/api/workflow`        | 工作流   | 工作流 CRUD、执行、步骤模板           |
| `/api/export`          | 导出     | 设备/告警/审计/拓扑导出               |
| `/api/bigscreen`       | 大屏     | 实时数据、配置管理、组件列表          |
| `/api/knowledge`       | 知识库   | 文章 CRUD、分类、标签、热门           |
| `/api/inventory`       | 盘点     | 资产概览、盘点任务、变更、报表        |
| `/api/oncall`          | 值班     | 当前值班、值班表、告警升级、交接      |
| `/api/dashboard`       | 仪表盘   | 用户配置、可用组件、组件数据          |

---

## 四、前端页面清单

### 已实现的 46 个页面组件

| 组件                         | 路径               | 功能         |
| ---------------------------- | ------------------ | ------------ |
| Dashboard                    | `/`                | 仪表盘首页   |
| TopologyView                 | `/topology`        | 2D/3D 拓扑   |
| DeviceList                   | `/devices`         | 设备列表     |
| AlertCenter                  | `/alerts`          | 告警中心     |
| UserManagement               | `/users`           | 用户管理     |
| Settings                     | `/settings`        | 系统设置     |
| AnalyticsDashboard           | `/analytics`       | 数据分析     |
| LicenseManagement            | `/license`         | 授权管理     |
| AuditLogs                    | `/audit`           | 审计日志     |
| OpenApiManagement            | `/openapi`         | 开放 API     |
| ConfigManagement             | `/config`          | 配置管理     |
| ReportCenter                 | `/report`          | 报表中心     |
| NotificationCenter           | `/notifications`   | 通知中心     |
| SystemMonitor                | `/system`          | 系统监控     |
| Login                        | `/login`           | 登录页       |
| NetworkDiscovery             | `/discovery`       | 网络发现     |
| AlertRuleManagement          | `/alert-rules`     | 告警规则     |
| ScheduleManagement           | `/schedule`        | 定时任务     |
| CollectorManagement          | `/collector`       | 采集器管理   |
| SnmpTemplateManagement       | `/snmp`            | SNMP 模板    |
| BackupManagement             | `/backup`          | 备份恢复     |
| SystemLogs                   | `/logs`            | 系统日志     |
| DeviceGroupManagement        | `/groups`          | 设备分组     |
| NotificationTemplates        | `/templates`       | 通知模板     |
| DeviceHealthScore            | `/health`          | 健康评分     |
| TopologyConnectionManagement | `/topology-manage` | 拓扑连接     |
| ApiUsageStats                | `/api-stats`       | API 统计     |
| MaintenanceManagement        | `/maintenance`     | 维护计划     |
| SshManagement                | `/ssh`             | SSH 管理     |
| TrafficAnalysis              | `/traffic`         | 流量分析     |
| PerformanceBaseline          | `/baseline`        | 性能基线     |
| WXWorkIntegration            | `/wxwork`          | 企业微信     |
| ComplianceCenter             | `/compliance`      | 合规审计     |
| WorkflowEditor               | `/workflow`        | 脚本编排     |
| DataExport                   | `/export`          | 数据导出     |
| BigScreen                    | `/bigscreen`       | 监控大屏     |
| KnowledgeBase                | `/knowledge`       | 知识库       |
| AssetInventory               | `/inventory`       | 资产盘点     |
| OncallManagement             | `/oncall`          | 值班管理     |
| DashboardCustomize           | `/dashboard-edit`  | 仪表盘自定义 |

---

## 五、代码质量

### Lint 修复记录

| 文件                  | 修复数量 | 类型               |
| --------------------- | :------: | ------------------ |
| OpenApiManagement.jsx |    5     | 未使用变量         |
| ReportCenter.jsx      |    1     | 未使用变量         |
| auth.ts               |    3     | 类型导入、空值检查 |
| health.test.ts        |    8     | 类型断言           |

### 构建状态

```
✓ 3567 modules transformed
✓ built in 8.81s
✅ 前端构建成功
```

---

## 六、后续开发计划

### Phase 1（短期，1-2 天）✅ 已完成

- [x] License 后端强校验（设备点数、用户并发）
- [x] License 前端动态渲染（根据模块权限显隐菜单）
- [x] 运维脚本（install.sh, backup.sh, upgrade.sh）
- [x] Swagger/OpenAPI 文档集成

### Phase 2（中期，1-2 周）✅ 已完成

- [x] 配置管理后端真实化（数据库存储配置版本）
- [x] 报表后端真实化（实际数据生成）
- [x] 多渠道通知集成（邮件、钉钉、企微）
- [x] 设备监控大屏模式

### Phase 3（长期，2-4 周）✅ 已完成

- [x] Go 采集器开发（SNMP/SSH 协议）
- [x] SSH 设备管理（凭据管理、命令执行）
- [x] 拓扑自动发现（CDP/LLDP）
- [x] TimescaleDB 时序数据存储
- [x] 移动端 H5 适配

### Phase 4（待规划）

- [ ] Redis 缓存集成（高并发优化）
- [ ] 多租户支持
- [ ] 高可用灾备架构
- [ ] Flutter 移动端 App

---

## 七、技术债务

| 问题                  | 优先级 | 状态               |
| --------------------- | :----: | ------------------ |
| 部分后端使用模拟数据  | 🟡 中  | 逐步改进中         |
| ~~缺少 Go 采集层~~    |   ✅   | 已完成             |
| 缺少 Redis 缓存       | 🟢 低  | 高并发场景性能受限 |
| ~~缺少 TimescaleDB~~  |   ✅   | 已完成             |
| ~~缺少 SSH 设备管理~~ |   ✅   | 已完成             |

---

## 八、对标分析

| 功能       | 华为 iMaster | 思科 DNA | NetVis Pro |
| ---------- | :----------: | :------: | :--------: |
| 设备发现   |      ✅      |    ✅    |  ✅ 完成   |
| 拓扑可视化 |      ✅      |    ✅    |  ✅ 完成   |
| 配置管理   |      ✅      |    ✅    |  ⚠️ 部分   |
| 告警管理   |      ✅      |    ✅    |  ✅ 完成   |
| 性能监控   |      ✅      |    ✅    |  ✅ 完成   |
| 审计日志   |      ✅      |    ✅    |  ✅ 完成   |
| 开放 API   |      ✅      |    ✅    |  ✅ 完成   |
| 多租户     |      ✅      |    ✅    |  📋 待定   |

---

> 文档维护：NetVis Pro 开发团队
